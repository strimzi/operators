To configure the listener to use OAuth authentication, set the `type` property to `oauth`.

OAuth authentication can be configured in one of two main manners:

* Fast local token validation using authorization server's JWKS endpoint
* Introspection based token validation using authorization server's Introspection endpoint

.An example of using the JWKS endpoint
[source,yaml,subs=attributes+]
----
authentication:
  type: oauth
  maxSecondsWithoutReauthentication: 3600
  validIssuerUri: https://<auth_server_address>
  jwksEndpointUri: https://<auth_server_address>/<path_to_jwks_endpoint>
  userNameClaim: username
  tlsTrustedCertificates:
  - secretName: oauth-server-cert
    certificate: ca.crt
----

.An example of using Kubernetes API server as authorization server to accept ServiceAccount tokens

Kubernetes API server provides a JWKS endpoint with signing keys that can be used to validate the service account tokens.

[source,yaml,subs=attributes+]
----
authentication:
  type: oauth
  configureServiceAccountAuth: true
  maxSecondsWithoutReauthentication: 3600
  customClaimCheck: "@.['kubernetes.io'] && @.['kubernetes.io'].['namespace'] in ['example']"
----

By using `configureServiceAccountAuth: true` the listener will be autoconfigured to use the Kubernetes API server.

This is equivalent to:
[source,yaml,subs=attributes+]
----
authentication:
  type: oauth
  maxSecondsWithoutReauthentication: 3600
  customClaimCheck: "@.['kubernetes.io'] && @.['kubernetes.io'].['namespace'] in ['example']"
  jwksEnpointUri: https://kubernetes.default.svc.cluster.local/openid/v1/jwks
  validIssuerUri: https://kubernetes.default.svc.cluster.local
  serverBearerTokenLocation: /var/run/secrets/kubernetes.io/serviceaccount/token
  checkAccessTokenType: false
  includeAcceptHeader: false
  tlsTrustedCertificates:
    - secretName: oauth-server-cert
      certificate: ca.crt
----
The FQDN of the Kubernetes API server would not end in `.cluster.local` if environment variable `KUBERNETES_SERVICE_DNS_DOMAIN` is set to some other value.

Note that the `tlsTrustedCertificates` is configured to point to a manually created Secret that contains the Kubernetes API server public certificate, which is mounted to the running pods under `/var/run/secrets/kubernetes.io/serviceaccount/ca.crt`.
The secret can be mounted using the following command:
[source,shell,subs=attributes+]
----
kubectl get cm kube-root-ca.crt -o jsonpath="{['data']['ca\.crt']}" > /tmp/ca.crt
kubectl create secret generic oauth-server-cert --from-file=ca.crt=/tmp/ca.crt
----

When using `configureServiceAccountAuth: true` the trusted certificate to connect to Kubernetes OIDC server is configured automatically.

The configuration option `customClaimCheck` can be used to allow authentication on this listener to some clients only, based on the namespace where the client application is deployed or any other custom claim present in service account JWT token.

.An example of using the Introspection endpoint

[source,yaml,subs=attributes+]
----
authentication:
  type: oauth
  clientId: kafka-broker
  clientSecret:
    secretName: my-cluster-oauth
    key: clientSecret
  maxSecondsWithoutReauthentication: 3600
  validIssuerUri: https://<auth_server_address>
  introspectionEndpointUri: https://<auth_server_address>/<path_to_introspection_endpoint>
  userNameClaim: username
  tlsTrustedCertificates:
  - secretName: oauth-server-cert
    certificate: ca.crt
----
